(function(e){"use strict";function t(e,t){this.__init();this.values=t||{};this.configure(e);var n=this;return this}t.defaults={timeAfterWriting:250,form:{method:"POST",action:"#"}};t.prototype.__init=function(){this.fields=[]};t.prototype.configure=function(e){this.options=t.defaults.merge(e)};t.prototype.Field=function(){this.selected={form:this,node:null};this.field=function(e,n){var r=t.fields[e];if(typeof n=="string"||typeof n=="undefined"){r.setAttribute("name",n)}else if(typeof n=="object"){r.setAttributes(n)}this.selected.node=r;return this.add(r)};this.add=function(e){this.fields.push(e);return e};this.input=function(e){var t=this.field("input",e);return this.selected};this.textarea=function(e){var t=this.field("textarea",e);return this.selected};this.button=function(e){var t=this.field("button",e);t.type="submit";return this.selected};this.selected.on=function(e,t){this.form.Event().add(this.node,e,t);return this};return this};t.prototype.Form=function(){this.configure=function(e){this.options.form=this.options.form.merge(e)};this.get=function(){var e=document.createElement("form");e.setAttributes(this.options.form);var t=this;e.onsubmit=function(e){t.onSubmit(e,t.fields.map(function(e){return{field:e,value:e.value=="undefined"?"":e.value}}));if(t.preventDefault===true)e.preventDefault();return!t.preventDefault};return e};return this};t.prototype.Validator=function(){return this};t.prototype.Event=function(){this.timer=null;this.events=["writing","afterwriting","keypress","keydown","keyup","focus","blur","click","dblclick"];this.add=function(e,t,n){if(this.events.indexOf(t)>=0){if(typeof e["on"+t]=="undefined"){switch(t){case"writing":this.add(e,"keyup",n);break;case"afterwriting":var r=this;e.onkeyup=function(t){clearTimeout(r.timer);r.timer=setTimeout(function(){n(e.value,t)},r.options.timeAfterWriting)};break;default:throw new Error("Event type isn't implemented")}}else{e.addEventListener(t,function(t){n(e.value,t)},false)}}else{throw new Error("The "+t+" event is unknow.")}};return this};t.prototype.setWrapper=function(e){var t=document.querySelector(e);if(t!=null)this.wrapper=t;else throw new Error("Wrapper isn't found")};t.prototype.setFieldWrapper=function(e,t){var n=document.createElement(e);if(typeof t=="object")n.setAttributes(t);this.fieldWrap=n};t.prototype.setOnSubmit=function(e,t){this.onSubmit=e;this.preventDefault=t};t.prototype.render=function(){if(!this.wrapper)throw new Error("Wrapper must be defined.");var e=this.Form().get();for(var t in this.fields){if(this.fields.hasOwnProperty(t)){var n=this.fields[t];if(this.values[n.name]!="undefined"){n.setAttribute("value",this.values[n.name])}var r=n;if(typeof this.fieldWrap!="undefined"){r=this.fieldWrap.cloneNode();r.appendChild(n)}e.appendChild(r)}}this.wrapper.appendChild(e)};t.fields={input:document.createElement("input"),textarea:document.createElement("textarea"),button:document.createElement("button")};Object.prototype.setAttributes=function(e){for(var t in e){if(e.hasOwnProperty(t)){if(t=="innerContent")this.innerHTML=e[t];else this.setAttribute(t,e[t])}}return this};Object.prototype.merge=function(e){if(typeof e=="object"){for(var t in e){try{if(e[t].constructor==Object)this[t]=this[t].merge(e[t]);else this[t]=e[t]}catch(n){this[t]=e[t]}}}return this};e.FormBuilder=t})(this)
